const hamburger=document.querySelector('.hamburger');const navMenu=document.querySelector('.nav-menu');hamburger.addEventListener('click',()=>{hamburger.classList.toggle('active');navMenu.classList.toggle('active');});document.querySelectorAll('.nav-menu a').forEach(link=>{link.addEventListener('click',()=>{hamburger.classList.remove('active');navMenu.classList.remove('active');});});const sections=document.querySelectorAll('section[id]');const navLinks=document.querySelectorAll('.nav-menu li a:not(.cta-button)');const sectionObserverNav=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){const id=entry.target.getAttribute('id');navLinks.forEach(link=>{link.classList.remove('active');if(link.getAttribute('href')===`#${id}`){link.classList.add('active');}});}});},{rootMargin:'-80px 0px-50%0px'});sections.forEach(section=>{sectionObserverNav.observe(section);});const backToTopButton=document.querySelector('.back-to-top');window.addEventListener('scroll',()=>{if(window.scrollY>300){if(backToTopButton){backToTopButton.classList.add('show');}}else{if(backToTopButton){backToTopButton.classList.remove('show');}}});document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',function(e){e.preventDefault();const targetId=this.getAttribute('href');const target=document.querySelector(targetId);if(target){const navbar=document.querySelector('.navbar');const navbarHeight=navbar ? navbar.offsetHeight:80;const targetPosition=target.getBoundingClientRect().top+window.pageYOffset;const offsetPosition=targetPosition-navbarHeight-20;window.scrollTo({top:offsetPosition,behavior:'smooth'});}});});window.addEventListener('scroll',()=>{updateNavbarBackground();});const filterButtons=document.querySelectorAll('.filter-btn');const portfolioItems=document.querySelectorAll('.portfolio-item');filterButtons.forEach(button=>{button.addEventListener('click',()=>{filterButtons.forEach(btn=>btn.classList.remove('active'));button.classList.add('active');const filterValue=button.getAttribute('data-filter');portfolioItems.forEach(item=>{if(filterValue==='all'||item.getAttribute('data-category')===filterValue){item.style.display='block';item.style.animation='fadeInUp 0.5s ease';}else{item.style.display='none';}});});});document.addEventListener('DOMContentLoaded',function(){AOS.init({duration:800,easing:'ease-in-out',once:true,offset:100});});function getAllProjectImages(){const allImages=[];Object.keys(portfolioProjects).forEach(projectId=>{const project=portfolioProjects[projectId];project.images.forEach(image=>{allImages.push({src:image.src,caption:image.caption,projectTitle:project.title});});});return allImages;}function shuffleArray(array){const shuffled=[...array];for(let i=shuffled.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[shuffled[i],shuffled[j]]=[shuffled[j],shuffled[i]];}return shuffled;}let heroImages=[];let currentImageIndex=0;let heroSlideInterval;function changeHeroImage(imageSrc,updateIndex=false){const heroBgImg=document.querySelector('.hero-bg-img');const heroContainer=document.querySelector('.hero-background-image');if(heroBgImg&&heroContainer){const newImg=document.createElement('img');newImg.src=imageSrc;newImg.alt='Projekt wnętrza';newImg.className='hero-bg-img';newImg.style.position='absolute';newImg.style.top='0';newImg.style.left='0';newImg.style.width='100%';newImg.style.height='100%';newImg.style.objectFit='cover';newImg.style.objectPosition='center';newImg.style.opacity='0';newImg.style.transition='opacity 1.5s ease-in-out,transform 15s ease-in-out';newImg.style.zIndex='1';newImg.classList.add('zoom-active');heroContainer.appendChild(newImg);heroBgImg.style.zIndex='0';heroBgImg.style.transition='opacity 1.5s ease-in-out';if(newImg.complete){startFadeTransition();}else{newImg.onload=()=>{startFadeTransition();};}function startFadeTransition(){requestAnimationFrame(()=>{requestAnimationFrame(()=>{heroBgImg.style.opacity='0';newImg.style.opacity='1';});});setTimeout(()=>{if(heroBgImg.parentNode===heroContainer){heroBgImg.remove();}newImg.style.zIndex='';if(updateIndex){currentImageIndex=heroImages.findIndex(img=>img.src===imageSrc);updateGalleryActiveState();}},1600);}}}function updateGalleryActiveState(){const galleryItems=document.querySelectorAll('.gallery-item');if(heroImages.length===0||!heroImages[currentImageIndex])return;const currentImageSrc=heroImages[currentImageIndex].src;const currentFilename=currentImageSrc.split('/').pop();galleryItems.forEach((item,index)=>{const img=item.querySelector('.gallery-img');if(img&&img.src.includes(currentFilename)){item.style.opacity='1';item.style.transform='scale(1.1)';item.style.borderColor='#a88d80';}else{item.style.opacity='0.7';item.style.transform='scale(1)';item.style.borderColor='rgba(255,255,255,0.5)';}});}function startHeroSlideshow(){if(heroImages.length===0)return;heroSlideInterval=setInterval(()=>{currentImageIndex=(currentImageIndex+1)%heroImages.length;const nextIndex=(currentImageIndex+1)%heroImages.length;preloadNextHeroImage(nextIndex);changeHeroImage(heroImages[currentImageIndex].src,false);updateGalleryActiveState();},5000);}function stopHeroSlideshow(){if(heroSlideInterval){clearInterval(heroSlideInterval);}}function changeHeroImageManual(imageSrc){stopHeroSlideshow();changeHeroImage(imageSrc,true);setTimeout(()=>{startHeroSlideshow();},8000);}function initializeHeroImages(){const allImages=getAllProjectImages();heroImages=shuffleArray(allImages);if(heroImages.length>0){const initialImg=document.querySelector('.hero-bg-img');if(initialImg){initialImg.src=heroImages[0].src;}for(let i=1;i<=2&&i<heroImages.length;i++){const preloadImg=new Image();preloadImg.src=heroImages[i].src;}}}function preloadNextHeroImage(index){if(index<heroImages.length){const preloadImg=new Image();preloadImg.src=heroImages[index].src;}}function animateCounters(){const counters=document.querySelectorAll('.animated-counter.stat-number');counters.forEach(counter=>{const target=parseInt(counter.getAttribute('data-count'));let current=0;const increment=target/60;const updateCounter=()=>{if(current<target){current+=increment;counter.textContent=Math.floor(current);requestAnimationFrame(updateCounter);}else{counter.textContent=target;}};updateCounter();});}const heroObserver=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){animateCounters();heroObserver.unobserve(entry.target);}});},{threshold:0.3});const heroSection=document.querySelector('.hero');if(heroSection){heroObserver.observe(heroSection);}const observerOptions={threshold:0.1,rootMargin:'0px 0px-50px 0px'};const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.style.opacity='1';entry.target.style.transform='translateY(0)';}});},observerOptions);document.querySelectorAll('.service-card,.portfolio-item,.testimonial-card,.process-step').forEach(el=>{el.style.opacity='0';el.style.transform='translateY(30px)';el.style.transition='opacity 0.6s ease,transform 0.6s ease';observer.observe(el);});const contactForm=document.getElementById('contactForm');contactForm.addEventListener('submit',async(e)=>{e.preventDefault();const submitBtn=contactForm.querySelector('.submit-btn');const originalText=submitBtn.textContent;submitBtn.textContent='Wysyłam...';submitBtn.disabled=true;const formData=new FormData(contactForm);const formObject={};formData.forEach((value,key)=>{formObject[key]=value;});try{await new Promise(resolve=>setTimeout(resolve,2000));submitBtn.textContent='Wiadomość Wysłana!';submitBtn.style.background='#27ae60';showNotification('Dziękujemy!Odezwiemy się w ciągu 24 godzin.','success');contactForm.reset();setTimeout(()=>{submitBtn.textContent=originalText;submitBtn.disabled=false;submitBtn.style.background='';},3000);}catch(error){submitBtn.textContent='Błąd-Spróbuj Ponownie';submitBtn.style.background='#e74c3c';showNotification('Coś poszło nie tak.Spróbuj ponownie.','error');setTimeout(()=>{submitBtn.textContent=originalText;submitBtn.disabled=false;submitBtn.style.background='';},3000);}});function showNotification(message,type){const notification=document.createElement('div');notification.className=`notification ${type}`;notification.textContent=message;notification.style.cssText=`
position:fixed;top:100px;right:20px;padding:1rem 2rem;border-radius:10px;color:white;font-weight:600;z-index:9999;transform:translateX(400px);transition:transform 0.3s ease;${type==='success' ? 'background:#27ae60;':'background:#e74c3c;'}`;document.body.appendChild(notification);setTimeout(()=>{notification.style.transform='translateX(0)';},100);setTimeout(()=>{notification.style.transform='translateX(400px)';setTimeout(()=>{document.body.removeChild(notification);},300);},5000);}function validateForm(){const name=document.getElementById('name').value.trim();const email=document.getElementById('email').value.trim();const projectType=document.getElementById('project-type').value;const message=document.getElementById('message').value.trim();const errors=[];if(name.length<2){errors.push('Name must be at least 2 characters long');}const emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!emailRegex.test(email)){errors.push('Please enter a valid email address');}if(!projectType){errors.push('Please select a project type');}if(message.length<10){errors.push('Message must be at least 10 characters long');}return errors;}document.querySelectorAll('#contactForm input,#contactForm select,#contactForm textarea').forEach(field=>{field.addEventListener('input',()=>{trackFieldCompletion(field);});field.addEventListener('blur',()=>{const errors=validateForm();const submitBtn=document.querySelector('.submit-btn');if(errors.length===0){submitBtn.style.opacity='1';submitBtn.disabled=false;}else{submitBtn.style.opacity='0.7';}trackFieldCompletion(field);});});window.addEventListener('load',async()=>{document.body.classList.add('loaded');initializeTheme();initializeHeroImages();const supportsWebP=await detectWebPSupport();document.documentElement.classList.add(supportsWebP ? 'webp-support':'no-webp');initializePWAFeatures();setTimeout(()=>{hidePageLoader();},1000);const heroElements=document.querySelectorAll('.hero-text-container>*');heroElements.forEach((el,index)=>{el.style.opacity='0';el.style.transform='translateY(30px)';el.style.transition='opacity 0.8s ease,transform 0.8s ease';setTimeout(()=>{el.style.opacity='1';el.style.transform='translateY(0)';},index*150+1500);});setTimeout(()=>{startHeroSlideshow();updateGalleryActiveState();const initialImg=document.querySelector('.hero-bg-img');if(initialImg){initialImg.classList.add('zoom-active');}},3000);});const sectionObserver=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('section-visible');}});},{threshold:0.1,rootMargin:'0px 0px-100px 0px'});document.querySelectorAll('section').forEach(section=>{section.style.opacity='0';section.style.transform='translateY(50px)';section.style.transition='opacity 0.8s ease,transform 0.8s ease';sectionObserver.observe(section);});const style=document.createElement('style');style.textContent=`.section-visible{opacity:1!important;transform:translateY(0)!important;}`;document.head.appendChild(style);function toggleDarkMode(){const currentTheme=document.documentElement.getAttribute('data-theme');const newTheme=currentTheme==='dark' ? 'light':'dark';document.documentElement.setAttribute('data-theme',newTheme);localStorage.setItem('theme',newTheme);const themeColor=newTheme==='dark' ? '#1c2726':'#a88d80';document.querySelector('meta[name=\"theme-color\"]').setAttribute('content',themeColor);updateNavbarBackground();const message=newTheme==='dark' ? 'Tryb ciemny włączony':'Tryb jasny włączony';const icon=newTheme==='dark' ? '🌙':'☀️';showEnhancedNotification('Zmiana motywu',message,'info',icon);}function updateNavbarBackground(){const navbar=document.querySelector('.navbar');const isDarkMode=document.documentElement.getAttribute('data-theme')==='dark';if(window.scrollY>100){if(isDarkMode){navbar.style.background='rgba(13,17,23,0.98)';navbar.style.boxShadow='0 2px 20px rgba(0,0,0,0.3)';}else{navbar.style.background='rgba(255,255,255,0.98)';navbar.style.boxShadow='0 2px 20px rgba(0,0,0,0.1)';}}else{if(isDarkMode){navbar.style.background='rgba(13,17,23,0.95)';navbar.style.boxShadow='none';}else{navbar.style.background='rgba(255,255,255,0.95)';navbar.style.boxShadow='none';}}}function initializeTheme(){const savedTheme=localStorage.getItem('theme');const prefersDark=window.matchMedia('(prefers-color-scheme:dark)').matches;const theme=savedTheme||(prefersDark ? 'dark':'light');document.documentElement.setAttribute('data-theme',theme);const themeColor=theme==='dark' ? '#1c2726':'#a88d80';document.querySelector('meta[name=\"theme-color\"]').setAttribute('content',themeColor);setTimeout(()=>{updateNavbarBackground();},100);}window.matchMedia('(prefers-color-scheme:dark)').addEventListener('change',(e)=>{if(!localStorage.getItem('theme')){const newTheme=e.matches ? 'dark':'light';document.documentElement.setAttribute('data-theme',newTheme);const themeColor=newTheme==='dark' ? '#2d2d2d':'#c9a96e';document.querySelector('meta[name=\"theme-color\"]').setAttribute('content',themeColor);}});function detectWebPSupport(){return new Promise((resolve)=>{const webP=new Image();webP.onload=webP.onerror=function(){resolve(webP.height===2);};webP.src='data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA});}function initializePWAFeatures(){if('serviceWorker' in navigator){navigator.serviceWorker.addEventListener('controllerchange',()=>{showEnhancedNotification('Aktualizacja dostępna','Strona została zaktualizowana.Odśwież,aby zobaczyć najnowszą wersję.','info','🔄');});}function updateOnlineStatus(){const status=navigator.onLine ? 'online':'offline';if(status==='offline'){showEnhancedNotification('Brak połączenia','Jesteś offline.Niektóre funkcje mogą być niedostępne.','error','📡');}else{showEnhancedNotification('Połączono','Połączenie z internetem zostało przywrócone.','success','🌐');}}window.addEventListener('online',updateOnlineStatus);window.addEventListener('offline',updateOnlineStatus);}const portfolioProjects={'project_1':{title:'Nowoczesne Mieszkanie w Ząbkach',description:'Kompleksowy projekt mieszkania łączący funkcjonalność z nowoczesną estetyką.Otwarta strefa dzienna płynnie przechodzi w kuchnię,tworząc przestrzeń idealną do życia rodzinnego.Projekt wyróżnia się przemyślanym oświetleniem,elegancką kolorystyką i dbałością o każdy detal.',location:'Ząbki',area:'~75m²',tags:['Mieszkanie','Nowoczesne','Salon','Kuchnia','Łazienka'],images:[{src:'images/renders/Project_1_zab/Widok salon-kuchnia_full.webp',caption:'Widok na salon i kuchnię'},{src:'images/renders/Project_1_zab/Widok kanapa I_full.webp',caption:'Strefa relaksu z kanapą'},{src:'images/renders/Project_1_zab/Telewizor_CShading_LightMix_full.webp',caption:'Strefa telewizyjna'},{src:'images/renders/Project_1_zab/Kuchnia_full.webp',caption:'Nowoczesna kuchnia'},{src:'images/renders/Project_1_zab/Widok na korytarz_full.webp',caption:'Widok na korytarz'},{src:'images/renders/Project_1_zab/korytarz_CShading_LightMix001_full.webp',caption:'Korytarz z oświetleniem'},{src:'images/renders/Project_1_zab/Lustro na korytarzu_CShading_LightMix001_full.webp',caption:'Lustro na korytarzu'},{src:'images/renders/Project_1_zab/Prysznic_CShading_LightMix001_full.webp',caption:'Strefa prysznicowa'},{src:'images/renders/Project_1_zab/Umywalka_CShading_LightMix_full.webp',caption:'Strefa umywalkowa'}]},'project_2':{title:'Elegancki Apartament w Wilanowie',description:'Luksusowy apartament łączący klasyczną elegancję z nowoczesnymi rozwiązaniami.Przestronny salon z wysokimi sufitami,designerska kuchnia oraz elegancka łazienka tworzą harmonijną całość.Projekt charakteryzuje się subtelną kolorystyką,naturalnymi materiałami i dbałością o detale.',location:'Wilanów,Warszawa',area:'~90m²',tags:['Apartament','Luksusowe','Wilanów','Designerskie','Eleganckie'],images:[{src:'images/renders/Project_2_wil/caly salon_full.webp',caption:'Panorama salonu'},{src:'images/renders/Project_2_wil/salon_full.webp',caption:'Strefa wypoczynkowa'},{src:'images/renders/Project_2_wil/kanapa_CShading_LightMix_full.webp',caption:'Designerska kanapa'},{src:'images/renders/Project_2_wil/tv_CShading_LightMix_full.webp',caption:'Strefa telewizyjna'},{src:'images/renders/Project_2_wil/Stół_CShading_LightMix_full.webp',caption:'Strefa jadalna'},{src:'images/renders/Project_2_wil/Kuchnia_po_PS_full.webp',caption:'Kuchnia z wyspą'},{src:'images/renders/Project_2_wil/Kuchnia detal_CShading_LightMix_full.webp',caption:'Detal kuchenny'},{src:'images/renders/Project_2_wil/Jaśniejsze_full.webp',caption:'Jasna przestrzeń'},{src:'images/renders/Project_2_wil/Detal_full.webp',caption:'Detal dekoracyjny'},{src:'images/renders/Project_2_wil/Detal_CShading_LightMix_full.webp',caption:'Detal z oświetleniem'},{src:'images/renders/Project_2_wil/łazienka_full.webp',caption:'Elegancka łazienka'},{src:'images/renders/Project_2_wil/Umywalka_full.webp',caption:'Strefa umywalkowa'}]},'project_3':{title:'Ciepłe Mieszkanie na Bemowie',description:'Przytulne mieszkanie rodzinne z ciepłą,naturalną kolorystyką.Projekt stawia na komfort i funkcjonalność,łącząc przestrzeń dzienną z kuchnią i osobną sypialnią.Naturalne materiały,drewniane akcenty i przemyślane oświetlenie tworzą atmosferę spokoju i harmonii.',location:'Bemowo,Warszawa',area:'~65m²',tags:['Mieszkanie','Rodzinne','Ciepłe','Naturalne','Przytulne'],images:[{src:'images/renders/Project_3_mag/Kanapa_full.webp',caption:'Salon z kanapą'},{src:'images/renders/Project_3_mag/Po_full.webp',caption:'Strefa wypoczynkowa'},{src:'images/renders/Project_3_mag/detal_full.webp',caption:'Detal projektowy'},{src:'images/renders/Project_3_mag/Kuchnia_full.webp',caption:'Funkcjonalna kuchnia'},{src:'images/renders/Project_3_mag/kuchnia2_full.webp',caption:'Widok na kuchnię'},{src:'images/renders/Project_3_mag/Sypialnia_full.webp',caption:'Przytulna sypialnia'},{src:'images/renders/Project_3_mag/Sypialnia2_full.webp',caption:'Strefa nocna'},{src:'images/renders/Project_3_mag/Łazienka 2_full.webp',caption:'Nowoczesna łazienka'}]},'project_4':{title:'Nowoczesne Mieszkanie w Kazimierzu',description:'Minimalistyczny projekt mieszkania z otwartą przestrzenią dzienną.Przemyślany układ funkcjonalny zapewnia wygodę użytkowania,a nowoczesny design z subtelnymi akcentami tworzy elegancką całość.Projekt charakteryzuje się czystymi liniami i harmonijną kompozycją.',location:'Kazimierz',area:'~70m²',tags:['Mieszkanie','Minimalistyczne','Nowoczesne','Funkcjonalne'],images:[{src:'images/renders/Project_4_kaz/Widok na tv_full.webp',caption:'Widok na strefę TV'},{src:'images/renders/Project_4_kaz/Widok na kanapę_full.webp',caption:'Widok na kanapę'},{src:'images/renders/Project_4_kaz/TV_full.webp',caption:'Strefa telewizyjna'},{src:'images/renders/Project_4_kaz/Widok na stół_full.webp',caption:'Strefa jadalna'},{src:'images/renders/Project_4_kaz/Widok na drzwi wejściowe_full.webp',caption:'Widok na wejście'},{src:'images/renders/Project_4_kaz/Widok na zabudowę_full.webp',caption:'Zabudowa meblowa'}]},'project_s1':{title:'Projekt Konkursowy-Opcja Pierwsza',description:'Minimalistyczna propozycja konkursowa łącząca czystość formy z funkcjonalnością.Projekt wyróżnia się elegancją,wykorzystaniem naturalnych materiałów i przemyślanym oświetleniem.Harmonijna kompozycja przestrzeni tworzy spokojną,nowoczesną atmosferę.',location:'Projekt Konkursowy',tags:['Konkurs','Minimalizm','Elegancja','Naturalne Materiały'],images:[{src:'images/renders/Project_S1/Ujęcie I_full.webp',caption:'Ujęcie I-perspektywa ogólna'},{src:'images/renders/Project_S1/Ujęcie II_full.webp',caption:'Ujęcie II-detal'},{src:'images/renders/Project_S1/Ujęcie III_full.webp',caption:'Ujęcie III-atmosfera wnętrza'}]},'project_s2':{title:'Projekt Konkursowy-Opcja Druga',description:'Nowoczesna wizja przestrzeni z ciepłymi akcentami.Projekt łączy funkcjonalność z estetyką,stawiając na harmonię kolorów i tekstur.Przemyślane oświetlenie i naturalne materiały tworzą przytulną,ale nowoczesną atmosferę.',location:'Projekt Konkursowy',tags:['Konkurs','Nowoczesne','Ciepłe Akcenty','Harmonia'],images:[{src:'images/renders/Project_S2/Ujęcie I_full.webp',caption:'Ujęcie I-widok ogólny'},{src:'images/renders/Project_S2/Ujęcie II_full.webp',caption:'Ujęcie II-kompozycja'},{src:'images/renders/Project_S2/Ujęcie III_full.webp',caption:'Ujęcie III-detale'}]},'project_s3':{title:'Projekt Konkursowy-Opcja Trzecia',description:'Harmonijne połączenie funkcjonalności i estetyki w przestrzeni mieszkalnej.Projekt charakteryzuje się przemyślanym układem,elegancką kolorystyką i dbałością o detale.Balans między nowoczesnością a przytulnością tworzy idealną przestrzeń do życia.',location:'Projekt Konkursowy',tags:['Konkurs','Funkcjonalność','Estetyka','Harmonia'],images:[{src:'images/renders/Project_S3/Ujęcie I_full.webp',caption:'Ujęcie I-koncepcja główna'},{src:'images/renders/Project_S3/Ujęcie II_full.webp',caption:'Ujęcie II-przestrzeń dzienna'},{src:'images/renders/Project_S3/Ujęcie III_full.webp',caption:'Ujęcie III-detale wnętrza'}]},'project_s4':{title:'Projekt Konkursowy-Opcja Czwarta',description:'Subtelna propozycja konkursowa stawiająca na detale i przemyślaną kompozycję.Projekt charakteryzuje się elegancją,czystością formy i funkcjonalnością.Harmonijna paleta kolorów i naturalne materiały tworzą spokojną,nowoczesną przestrzeń.',location:'Projekt Konkursowy',tags:['Konkurs','Subtelność','Detale','Kompozycja'],images:[{src:'images/renders/Project_S4/Ujęcie 1_full.webp',caption:'Ujęcie 1-wizja główna'},{src:'images/renders/Project_S4/Ujęcie 2_full.webp',caption:'Ujęcie 2-perspektywa'}]}};let currentLightboxIndex=0;let currentProjectData=null;let lastFocusedElement=null;function openLightbox(element){const portfolioItem=element.closest('.portfolio-item');if(!portfolioItem)return;const projectId=portfolioItem.getAttribute('data-project-id');const lightbox=document.getElementById('lightboxOverlay');currentProjectData=portfolioProjects[projectId];if(!currentProjectData){console.error('Project data not found for:',projectId);return;}lastFocusedElement=document.activeElement;currentLightboxIndex=0;displayLightboxImage(currentLightboxIndex);lightbox.classList.add('active');lightbox.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';const closeButton=lightbox.querySelector('.lightbox-close');if(closeButton){setTimeout(()=>closeButton.focus(),100);}}document.addEventListener('DOMContentLoaded',function(){const portfolioItems=document.querySelectorAll('.portfolio-item');portfolioItems.forEach(item=>{item.addEventListener('click',function(e){if(e.target.closest('a[href]:not([data-action])'))return;openLightbox(this);});});});function closeLightbox(){const lightbox=document.getElementById('lightboxOverlay');lightbox.classList.remove('active');lightbox.setAttribute('aria-hidden','true');document.body.style.overflow='auto';currentProjectData=null;if(lastFocusedElement){lastFocusedElement.focus();lastFocusedElement=null;}}function displayLightboxImage(index){if(!currentProjectData||!currentProjectData.images[index]){return;}const imageData=currentProjectData.images[index];const lightboxImg=document.getElementById('lightboxImage');const lightboxTitle=document.getElementById('lightboxTitle');const lightboxDesc=document.getElementById('lightboxDescription');const lightboxTags=document.getElementById('lightboxTags');lightboxImg.src=imageData.src;lightboxImg.alt=imageData.caption;const imageCounter=`${index+1}/${currentProjectData.images.length}`;lightboxTitle.textContent=`${currentProjectData.title}-${imageCounter}`;let descriptionHTML=`<strong>${imageData.caption}</strong><br>`;descriptionHTML+=currentProjectData.description;if(currentProjectData.location){descriptionHTML+=`<br><br><strong>Lokalizacja:</strong>${currentProjectData.location}`;}if(currentProjectData.area){descriptionHTML+=`|<strong>Powierzchnia:</strong>${currentProjectData.area}`;}lightboxDesc.innerHTML=descriptionHTML;lightboxTags.innerHTML='';currentProjectData.tags.forEach(tag=>{const tagElement=document.createElement('span');tagElement.className='lightbox-tag';tagElement.textContent=tag;lightboxTags.appendChild(tagElement);});}function nextImage(){if(!currentProjectData)return;currentLightboxIndex=(currentLightboxIndex+1)%currentProjectData.images.length;displayLightboxImage(currentLightboxIndex);}function previousImage(){if(!currentProjectData)return;currentLightboxIndex=(currentLightboxIndex-1+currentProjectData.images.length)%currentProjectData.images.length;displayLightboxImage(currentLightboxIndex);}function makeCall(phoneNumber){const cleanNumber=phoneNumber.replace(/\s+/g,'');if(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){window.location.href=`tel:${cleanNumber}`;}else{navigator.clipboard.writeText(phoneNumber).then(()=>{showEnhancedNotification('Numer telefonu skopiowany!',`${phoneNumber}został skopiowany do schowka`,'success','📞');}).catch(()=>{showEnhancedNotification('Numer telefonu',phoneNumber,'info','📞');});}}function sendEmail(emailAddress){const subject=encodeURIComponent('Zapytanie o projekt wnętrza');const body=encodeURIComponent('Dzień dobry,\n\nChciałbym/chciałabym uzyskać więcej informacji na temat Państwa usług projektowania wnętrz.\n\nZ poważaniem');window.location.href=`mailto:${emailAddress}?subject=${subject}&body=${body}`;}function showEnhancedNotification(title,message,type='info',icon=''){const notification=document.createElement('div');notification.className=`notification ${type}`;notification.innerHTML=`<div class="notification-icon">${icon}</div><div class="notification-content"><div class="notification-title">${title}</div><div class="notification-message">${message}</div></div>`;document.body.appendChild(notification);setTimeout(()=>{notification.classList.add('show');},100);setTimeout(()=>{notification.classList.remove('show');setTimeout(()=>{if(notification.parentNode){document.body.removeChild(notification);}},400);},5000);}const formSteps={1:['name','email','phone'],2:['project-type','budget'],3:['message']};let currentStep=1;let completedFields=new Set();function updateFormProgress(){const progressLine=document.getElementById('progressLine');const totalSteps=Object.keys(formSteps).length;let completedSteps=0;for(let step=1;step<=totalSteps;step++){const stepFields=formSteps[step];const stepCompleted=stepFields.every(fieldId=>{const field=document.getElementById(fieldId);return field&&field.value.trim()!=='';});const stepElement=document.getElementById(`step${step}`);if(stepCompleted){stepElement.classList.remove('active');stepElement.classList.add('completed');completedSteps++;}else if(stepFields.some(fieldId=>{const field=document.getElementById(fieldId);return field&&field.value.trim()!=='';})){stepElement.classList.add('active');stepElement.classList.remove('completed');currentStep=step;}else{stepElement.classList.remove('active','completed');}}const progressPercentage=(completedSteps/totalSteps)*100;progressLine.style.width=`${progressPercentage}%`;}function trackFieldCompletion(field){const fieldId=field.id;const value=field.value.trim();const formGroup=field.closest('.form-group');if(value!==''){completedFields.add(fieldId);formGroup.classList.add('completed');}else{completedFields.delete(fieldId);formGroup.classList.remove('completed');}updateFormProgress();}function hidePageLoader(){const loader=document.getElementById('pageLoader');if(loader){loader.classList.add('hidden');setTimeout(()=>{loader.style.display='none';},500);}}document.addEventListener('keydown',function(e){const lightbox=document.getElementById('lightboxOverlay');if(lightbox.classList.contains('active')){switch(e.key){case 'ArrowLeft':previousImage();break;case 'ArrowRight':nextImage();break;case 'Escape':closeLightbox();break;}}});document.getElementById('lightboxOverlay').addEventListener('click',function(e){if(e.target===this){closeLightbox();}});function openCompareModal(){const modal=document.getElementById("compareModal");modal.classList.add("show");document.body.style.overflow="hidden";}function closeCompareModal(){const modal=document.getElementById("compareModal");modal.classList.remove("show");document.body.style.overflow="auto";}document.addEventListener("keydown",function(event){if(event.key==="Escape"){closeCompareModal();}});document.querySelector(".compare-modal-content")?.addEventListener("click",function(e){e.stopPropagation();});document.addEventListener('click',function(e){const target=e.target.closest('[data-action]');if(!target)return;const action=target.getAttribute('data-action');switch(action){case 'open-lightbox':openLightbox(target);break;case 'close-lightbox':closeLightbox();break;case 'prev-image':previousImage();break;case 'next-image':nextImage();break;case 'open-compare':openCompareModal();break;case 'close-compare':closeCompareModal();break;case 'close-compare-bg':if(e.target===target){closeCompareModal();}break;case 'call':makeCall(target.getAttribute('data-phone'));break;case 'email':sendEmail(target.getAttribute('data-email'));break;case 'install-pwa':installPWA();break;case 'modal-content':e.stopPropagation();break;}});document.addEventListener('keydown',function(e){const target=e.target.closest('[data-action]');if(!target)return;if(e.key==='Enter'||e.key===' '){const action=target.getAttribute('data-action');if(e.key===' '){e.preventDefault();}switch(action){case 'open-compare':case 'close-compare':case 'call':case 'email':case 'install-pwa':target.click();break;}}});const themeToggles=document.querySelectorAll('.theme-toggle,.mobile-theme-toggle');themeToggles.forEach(toggle=>{toggle.addEventListener('click',toggleDarkMode);toggle.addEventListener('keydown',function(e){if(e.key==='Enter'||e.key===' '){e.preventDefault();toggleDarkMode();}});});document.querySelectorAll('.gallery-item[data-hero-image]').forEach(item=>{item.addEventListener('click',function(){const imageSrc=this.getAttribute('data-hero-image');changeHeroImageManual(imageSrc);});item.addEventListener('keydown',function(e){if(e.key==='Enter'||e.key===' '){e.preventDefault();const imageSrc=this.getAttribute('data-hero-image');changeHeroImageManual(imageSrc);}});});